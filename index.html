<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador del Teorema Central del L√≠mite</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
            background-color: #f9f9f9;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .controls {
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 8px;
            border: 2px solid #ddd;
        }
        .control-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
            align-items: center;
        }
        .control-group {
            flex: 1;
            min-width: 250px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .value-display {
            display: inline-block;
            background-color: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            min-width: 40px;
            text-align: center;
        }
        button {
            background-color: #2c3e50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 10px;
            font-size: 14px;
            font-weight: bold;
        }
        button:hover {
            background-color: #34495e;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-container {
            background-color: #fff;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
        }
        .chart-container h3 {
            color: #2c3e50;
            margin-top: 0;
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        .info-box {
            background-color: #e8f4fc;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
        }
        .results-table th, .results-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .results-table th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        .results-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .sample-controls {
            text-align: center;
            margin-top: 15px;
        }
        .sample-controls button {
            background-color: #27ae60;
            margin: 0 5px;
        }
        .sample-controls button:hover {
            background-color: #229954;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        h2 {
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Simulador del Teorema Central del L√≠mite</h1>
        
        <div class="info-box">
            <p><strong>üìä Esta aplicaci√≥n demuestra el Teorema Central del L√≠mite y el concepto de Error Est√°ndar.</strong> Podr√°s observar c√≥mo, al aumentar el tama√±o de muestra (n), la distribuci√≥n de medias muestrales se aproxima a una distribuci√≥n normal centrada en la media poblacional, mientras que el error est√°ndar (SE = œÉ/‚àön) disminuye. Ambos son conceptos fundamentales para entender la inferencia estad√≠stica, que se aplica en la estimaci√≥n de par√°metros de una poblaci√≥n, como en pruebas de hip√≥tesis o en modelos predictivos explicables como la regresi√≥n lineal al estimar sus par√°metros, de manera independiente de la forma de la distribuci√≥n de la poblaci√≥n.</p>
        </div>

        <div class="controls">
            <h2>‚öôÔ∏è Par√°metros de Control</h2>
            
            <div class="control-row">
                <div class="control-group">
                    <label for="distribution-type">üîÄ Tipo de Distribuci√≥n:</label>
                    <select id="distribution-type">
                        <option value="uniform">Uniforme</option>
                        <option value="normal">Normal</option>
                        <option value="exponential">Exponencial</option>
                        <option value="bimodal">Bimodal</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="population-mean">üìç Media Poblacional (Œº): <span id="population-mean-value" class="value-display">50</span></label>
                    <input type="range" id="population-mean" min="10" max="90" value="50" step="1">
                </div>
            </div>
            
            <div class="control-row">
                <div class="control-group">
                    <label for="population-sd">üìè Desviaci√≥n Est√°ndar Poblacional (œÉ): <span id="population-sd-value" class="value-display">15</span></label>
                    <input type="range" id="population-sd" min="1" max="30" value="15" step="1">
                </div>
                
                <div class="control-group">
                    <label for="sample-size">üéØ Tama√±o de la Muestra (n): <span id="sample-size-value" class="value-display">5</span></label>
                    <input type="range" id="sample-size" min="1" max="100" value="5" step="1">
                </div>
            </div>
            
            <div class="control-row">
                <div class="control-group">
                    <label for="num-samples">üî¢ N√∫mero de Muestras: <span id="num-samples-value" class="value-display">100</span></label>
                    <input type="range" id="num-samples" min="10" max="1000" value="100" step="10">
                </div>
                
                <div class="control-group" style="display: flex; align-items: flex-end; gap: 10px;">
                    <button id="run-simulation">üöÄ Ejecutar Simulaci√≥n</button>
                    <button id="reset-simulation">üîÑ Reiniciar</button>
                </div>
            </div>
        </div>

        <div class="chart-grid">
            <div class="chart-container">
                <h3>üìà Distribuci√≥n Poblacional</h3>
                <div class="chart-wrapper">
                    <canvas id="populationChart"></canvas>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>üé≤ Muestra Individual</h3>
                <div class="chart-wrapper">
                    <canvas id="sampleChart"></canvas>
                </div>
                <div class="sample-controls">
                    <button id="prev-sample">‚Üê Anterior</button>
                    <span id="sample-info">Muestra 1 de 100</span>
                    <button id="next-sample">Siguiente ‚Üí</button>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>üìä Distribuci√≥n de Medias Muestrales</h3>
                <div class="chart-wrapper">
                    <canvas id="samplingChart"></canvas>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>üìâ Error Est√°ndar vs Tama√±o de Muestra</h3>
                <div class="chart-wrapper">
                    <canvas id="errorChart"></canvas>
                </div>
            </div>
        </div>

        <div class="info-box">
            <h2>üìã Resultados de la Simulaci√≥n</h2>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Par√°metro</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Media Poblacional (Œº)</td>
                        <td id="result-pop-mean">-</td>
                    </tr>
                    <tr>
                        <td>Desviaci√≥n Est√°ndar Poblacional (œÉ)</td>
                        <td id="result-pop-sd">-</td>
                    </tr>
                    <tr>
                        <td>Tama√±o de Muestra (n)</td>
                        <td id="result-sample-size">-</td>
                    </tr>
                    <tr>
                        <td>Error Est√°ndar Te√≥rico (œÉ/‚àön)</td>
                        <td id="result-theoretical-se">-</td>
                    </tr>
                    <tr>
                        <td>Media de las Medias Muestrales</td>
                        <td id="result-sample-means-mean">-</td>
                    </tr>
                    <tr>
                        <td>Error Est√°ndar Emp√≠rico</td>
                        <td id="result-sample-means-sd">-</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="info-box">
            <h2>üìö Explicaci√≥n del Teorema Central del L√≠mite</h2>
            <p><strong>El Teorema Central del L√≠mite (TCL)</strong> establece que, al tomar muestras aleatorias repetidas de tama√±o n de manera indefinida de una poblaci√≥n, se genera una distribuci√≥n de los promedios de las muestras que tiene las siguientes propiedades:</p>
            <ul>
                <li>üéØ Media igual a la media poblacional (Œº)</li>
                <li>üìè Desviaci√≥n est√°ndar igual a la desviaci√≥n est√°ndar poblacional dividida por la ra√≠z cuadrada del tama√±o de la muestra (œÉ/‚àön). Este valor se denomina <strong>Error Est√°ndar</strong>.</li>
                <li>üìà En la medida que el n de las muestras es suficientemente grande (30), la forma de la distribuci√≥n de los promedios se aproxima a la normal</li>
            </ul>
            
            <h3>üîç Observaciones clave de esta simulaci√≥n:</h3>
            <ul>
                <li>üßÆ La f√≥rmula del <strong>Error Est√°ndar</strong> (SE = œÉ/‚àön) modela el concepto del teorema central del l√≠mite.</li>
                <li>üìä A medida que aumenta el tama√±o de muestra (n), la distribuci√≥n de medias muestrales se vuelve m√°s estrecha (menor variabilidad) y la forma de la distribuci√≥n de medias muestrales se aproxima a una normal incluso cuando la distribuci√≥n poblacional no lo es.</li>
            </ul>
        </div>
    </div>

    <script>
        // Variables globales
        let populationData = [];
        let allSamples = [];
        let sampleMeans = [];
        let currentSampleIndex = 0;
        
        // Configuraci√≥n inicial
        let populationMean = 50;
        let populationSd = 15;
        let sampleSize = 5;
        let numSamples = 100;
        let distributionType = "uniform";
        
        // Referencias a los gr√°ficos
        let populationChart, sampleChart, samplingChart, errorChart;
        
        // Funci√≥n para generar n√∫meros aleatorios con distribuci√≥n normal (Box-Muller)
        function normalRandom(mean = 0, sd = 1) {
            let u = 0, v = 0;
            while(u === 0) u = Math.random();
            while(v === 0) v = Math.random();
            let z = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
            return z * sd + mean;
        }
        
        // Funci√≥n para generar la poblaci√≥n
        function generatePopulation() {
            populationData = [];
            
            for (let i = 0; i < 10000; i++) {
                let value;
                
                switch(distributionType) {
                    case "uniform":
                        const range = Math.sqrt(12) * populationSd;
                        const min = populationMean - range / 2;
                        const max = populationMean + range / 2;
                        value = min + Math.random() * (max - min);
                        break;
                        
                    case "normal":
                        value = normalRandom(populationMean, populationSd);
                        break;
                        
                    case "exponential":
                        const lambda = 1 / populationSd;
                        const shift = populationMean - populationSd;
                        value = -Math.log(Math.random()) / lambda + shift;
                        break;
                        
                    case "bimodal":
                        if (Math.random() < 0.5) {
                            value = normalRandom(populationMean - 20, populationSd/1.5);
                        } else {
                            value = normalRandom(populationMean + 20, populationSd/1.5);
                        }
                        break;
                }
                
                populationData.push(value);
            }
        }
        
        // Funci√≥n para tomar muestras
        function takeSamples() {
            allSamples = [];
            sampleMeans = [];
            
            for (let i = 0; i < numSamples; i++) {
                const sample = [];
                for (let j = 0; j < sampleSize; j++) {
                    const randomIndex = Math.floor(Math.random() * populationData.length);
                    sample.push(populationData[randomIndex]);
                }
                allSamples.push(sample);
                sampleMeans.push(sample.reduce((a, b) => a + b, 0) / sample.length);
            }
        }
        
        // Funci√≥n para crear histograma de datos
        function createHistogramData(data, bins = 30) {
            const min = Math.min(...data);
            const max = Math.max(...data);
            const binWidth = (max - min) / bins;
            
            const histogram = new Array(bins).fill(0);
            const labels = [];
            
            for (let i = 0; i < bins; i++) {
                labels.push((min + i * binWidth).toFixed(1));
            }
            
            data.forEach(value => {
                const binIndex = Math.min(Math.floor((value - min) / binWidth), bins - 1);
                histogram[binIndex]++;
            });
            
            return { data: histogram, labels };
        }
        
        // Funci√≥n para actualizar gr√°fico de poblaci√≥n
        function updatePopulationChart() {
            const histData = createHistogramData(populationData);
            
            if (populationChart) {
                populationChart.destroy();
            }
            
            const ctx = document.getElementById('populationChart').getContext('2d');
            populationChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: histData.labels,
                    datasets: [{
                        label: 'Frecuencia',
                        data: histData.data,
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Frecuencia'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Valores'
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para actualizar gr√°fico de muestra individual
        function updateSampleChart() {
            if (allSamples.length === 0) return;
            
            const sample = allSamples[currentSampleIndex];
            const sampleMean = sampleMeans[currentSampleIndex];
            
            if (sampleChart) {
                sampleChart.destroy();
            }
            
            const ctx = document.getElementById('sampleChart').getContext('2d');
            sampleChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Valores de la muestra',
                        data: sample.map((value, index) => ({x: index + 1, y: value})),
                        backgroundColor: 'rgba(231, 76, 60, 0.7)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        pointRadius: 6
                    }, {
                        label: `Media muestral: ${sampleMean.toFixed(2)}`,
                        data: sample.map((_, index) => ({x: index + 1, y: sampleMean})),
                        type: 'line',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    }, {
                        label: `Media poblacional: ${populationMean}`,
                        data: sample.map((_, index) => ({x: index + 1, y: populationMean})),
                        type: 'line',
                        borderColor: 'rgba(39, 174, 96, 1)',
                        borderDash: [2, 2],
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Elemento de la muestra'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Valor'
                            }
                        }
                    }
                }
            });
            
            document.getElementById('sample-info').textContent = 
                `Muestra ${currentSampleIndex + 1} de ${numSamples}`;
        }
        
        // Funci√≥n para actualizar gr√°fico de distribuci√≥n de medias muestrales
        function updateSamplingChart() {
            const histData = createHistogramData(sampleMeans);
            
            if (samplingChart) {
                samplingChart.destroy();
            }
            
            const ctx = document.getElementById('samplingChart').getContext('2d');
            samplingChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: histData.labels,
                    datasets: [{
                        label: 'Frecuencia',
                        data: histData.data,
                        backgroundColor: 'rgba(155, 89, 182, 0.7)',
                        borderColor: 'rgba(155, 89, 182, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Frecuencia'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Medias Muestrales'
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para actualizar gr√°fico de error est√°ndar
        function updateErrorChart() {
            const nValues = [];
            const seValues = [];
            
            for (let n = 1; n <= 100; n++) {
                nValues.push(n);
                seValues.push(populationSd / Math.sqrt(n));
            }
            
            if (errorChart) {
                errorChart.destroy();
            }
            
            const ctx = document.getElementById('errorChart').getContext('2d');
            errorChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: nValues,
                    datasets: [{
                        label: 'Error Est√°ndar',
                        data: seValues,
                        borderColor: 'rgba(241, 196, 15, 1)',
                        backgroundColor: 'rgba(241, 196, 15, 0.1)',
                        borderWidth: 2,
                        pointRadius: 1,
                        fill: true
                    }, {
                        label: `n actual = ${sampleSize}`,
                        data: [{x: sampleSize, y: populationSd / Math.sqrt(sampleSize)}],
                        backgroundColor: 'rgba(231, 76, 60, 1)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        pointRadius: 8,
                        showLine: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Tama√±o de Muestra (n)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Error Est√°ndar (œÉ/‚àön)'
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para actualizar la tabla de resultados
        function updateResultsTable() {
            const theoreticalSE = populationSd / Math.sqrt(sampleSize);
            const empiricalMean = sampleMeans.reduce((a, b) => a + b, 0) / sampleMeans.length;
            const empiricalSE = Math.sqrt(sampleMeans.reduce((sum, mean) => 
                sum + Math.pow(mean - empiricalMean, 2), 0) / (sampleMeans.length - 1));
            
            document.getElementById("result-pop-mean").textContent = populationMean.toFixed(2);
            document.getElementById("result-pop-sd").textContent = populationSd.toFixed(2);
            document.getElementById("result-sample-size").textContent = sampleSize;
            document.getElementById("result-theoretical-se").textContent = theoreticalSE.toFixed(4);
            document.getElementById("result-sample-means-mean").textContent = empiricalMean.toFixed(4);
            document.getElementById("result-sample-means-sd").textContent = empiricalSE.toFixed(4);
        }
        
        // Funci√≥n principal de simulaci√≥n
        function runSimulation() {
            generatePopulation();
            takeSamples();
            currentSampleIndex = 0;
            
            updatePopulationChart();
            updateSampleChart();
            updateSamplingChart();
            updateErrorChart();
            updateResultsTable();
        }
        
        // Event listeners
        document.getElementById("population-mean").addEventListener("input", function() {
            populationMean = parseInt(this.value);
            document.getElementById("population-mean-value").textContent = populationMean;
        });
        
        document.getElementById("population-sd").addEventListener("input", function() {
            populationSd = parseInt(this.value);
            document.getElementById("population-sd-value").textContent = populationSd;
        });
        
        document.getElementById("sample-size").addEventListener("input", function() {
            sampleSize = parseInt(this.value);
            document.getElementById("sample-size-value").textContent = sampleSize;
        });
        
        document.getElementById("num-samples").addEventListener("input", function() {
            numSamples = parseInt(this.value);
            document.getElementById("num-samples-value").textContent = numSamples;
        });
        
        document.getElementById("distribution-type").addEventListener("change", function() {
            distributionType = this.value;
        });
        
        document.getElementById("run-simulation").addEventListener("click", runSimulation);
        
        document.getElementById("reset-simulation").addEventListener("click", function() {
            populationMean = 50;
            populationSd = 15;
            sampleSize = 5;
            numSamples = 100;
            distributionType = "uniform";
            
            document.getElementById("population-mean").value = 50;
            document.getElementById("population-mean-value").textContent = 50;
            document.getElementById("population-sd").value = 15;
            document.getElementById("population-sd-value").textContent = 15;
            document.getElementById("sample-size").value = 5;
            document.getElementById("sample-size-value").textContent = 5;
            document.getElementById("num-samples").value = 100;
            document.getElementById("num-samples-value").textContent = 100;
            document.getElementById("distribution-type").value = "uniform";
            
            runSimulation();
        });
        
        document.getElementById("prev-sample").addEventListener("click", function() {
            if (allSamples.length > 0) {
                currentSampleIndex = (currentSampleIndex - 1 + allSamples.length) % allSamples.length;
                updateSampleChart();
            }
        });
        
        document.getElementById("next-sample").addEventListener("click", function() {
            if (allSamples.length > 0) {
                currentSampleIndex = (currentSampleIndex + 1) % allSamples.length;
                updateSampleChart();
            }
        });
        
        // Ejecutar la simulaci√≥n inicial cuando se carga la p√°gina
        window.addEventListener('load', function() {
            runSimulation();
        });
    </script>
</body>
</html>
